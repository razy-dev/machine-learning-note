:rootdir: ..
:chapter: recurrent_neural_network
include::{rootdir}/adoc/toc.adoc[]

[source, python]
----
include::{sourcedir}/rnn_numpy.py[tag=preset]
----

[source, python]
----
include::{sourcedir}/rnn_numpy.py[tag=design]
----

stem:[
\begin{align}
    input   &= (10, 4) \\
            &= \begin{bmatrix}
                \begin{bmatrix} x_{0,0} & x_{0,1} & x_{0,2} & x_{0,3} \end{bmatrix} \\
                \begin{bmatrix} x_{1,0} & x_{1,1} & x_{1,2} & x_{1,3} \end{bmatrix} \\
                \cdots \\
                \begin{bmatrix} x_{9,0} & x_{9,1} & x_{9,2} & x_{9,3} \end{bmatrix} \\
            \end{bmatrix} \\
    \\
    Wx   &= (8, 4) \\
            &= \begin{bmatrix}
                \begin{bmatrix} Wx_{0,0} & Wx_{0,1} & Wx_{0,2} & Wx_{0,3} \end{bmatrix} \\
                \begin{bmatrix} Wx_{1,0} & Wx_{1,1} & Wx_{1,2} & Wx_{1,3} \end{bmatrix} \\
                \cdots \\
                \begin{bmatrix} Wx_{7,0} & Wx_{7,1} & Wx_{7,2} & Wx_{7,3} \end{bmatrix} \\
            \end{bmatrix} \\
    \\
    Wh   &= (8, 8) \\
            &= \begin{bmatrix}
                \begin{bmatrix} Wh_{0,0} & Wh_{0,1} & Wh_{0,2} & Wh_{0,3} & Wh_{0,4} & Wh_{0,5} & Wh_{0,6} & Wh_{0,7} \end{bmatrix} \\
                \begin{bmatrix} Wh_{1,0} & Wh_{1,1} & Wh_{1,2} & Wh_{1,3} & Wh_{1,4} & Wh_{1,5} & Wh_{1,6} & Wh_{1,7} \end{bmatrix} \\
                \cdots \\
                \begin{bmatrix} Wh_{7,0} & Wh_{7,1} & Wh_{7,2} & Wh_{7,3} & Wh_{7,4} & Wh_{7,5} & Wh_{7,6} & Wh_{7,7} \end{bmatrix} \\
            \end{bmatrix} \\
    \\
    b   &= (8, ) \\
            &= \begin{bmatrix}
                b_0 \\
                b_1 \\
                \cdots \\
                b_7 \\
            \end{bmatrix} \\
    \\
    h_t &= Wx \times x + Wh \times h_{t-1} + b \\
        &= (8, 4) \times (4, 1) + (8, 8) \times (8, 1) + (8, 1) \\
        &= (8, 1) + (8, 1) + (8, 1) \\
        &= (8, 1) \\
\end{align}
]

[source, python]
----
include::{sourcedir}/rnn_numpy.py[tag=dataset]
----

[source, python]
----
include::{sourcedir}/rnn_numpy.py[tag=parameters]
----

[source, python]
----
include::{sourcedir}/rnn_numpy.py[tag=rnn]
----
